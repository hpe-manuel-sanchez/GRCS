/// <reference path="/GCS/Scripts/Custom/LayoutRoot.js" />

var messages = {
    consentPeriod: "Please select Consent period"
};

$(function () {

    $("table.sample tr:even").css("background-color", "#F6F7F9");
    $("table.sample tr:odd").css("background-color", "#EAF0F6");

    $('#btnSaveContract').click(function (e) {
        e.preventDefault();
        var result = true;
        $("select.restrictionList").each(function () {
            var temp = $(this).val();
            if (temp == 2 || temp == 5) {
                var item = $($("select.consentList")[$("select.restrictionList").index(this)]);
                if (item.val() == 0) {
                    var newDialog = $('<div id="MenuDialog">\             <p>'+messages.consentPeriod+'</p>\         </div>');
                    //Show Dialog
                    newDialog.dialog({
                        modal: true,
                        title: messageCommon.warningTitle,
                        show: 'clip',
                        hide: 'clip',
                        width: 300,
                        buttons: { 'Ok': function () { $(this).dialog('close'); item.focus(); } },
                        close: function () { item.focus(); }
                    });
                    result = false;
                    return false;
                }
            }
            return false;
        });

        //

        if (result == true) {
            $.post('/GCS/Contract/SaveSecondaryExploitation', $("#SecExpForm").serialize(), function (data) {
                $('#divSecTab').html(data);
            })
                .error(function () {
                    var newDialog = $('<div id="MenuDialog">\             <p> ' + e + ' </p>\         </div>');
                    //Show Dialog
                    newDialog.dialog({
                        modal: true,
                        title: messageCommon.warningTitle,
                        show: 'clip',
                        hide: 'clip',
                        width: 300
                    });
                });
        }
        //

    });

});

    // The below logic enables DigitalConsentList only when DigitalRestrictionList is 'Consult' or 'Consent Required' as part of UAT Bug RC:22  

    $(function () {
        $('select.restrictionList').change(function () {
            var temp = $(this).val();

            if (temp == 1 || temp == 3 || temp == 4) {
                $($("select.consentList")[$("select.restrictionList").index(this)]).attr("disabled", true);
            }
            else {
                $($("select.consentList")[$("select.restrictionList").index(this)]).attr("disabled", false);
            }
        });
    });    

$(function () {

    $('#btnSaveContractTemplate').click(function (e) {
        e.preventDefault();
        var result = true;
        //
        $("select.restrictionList").each(function () {
            var temp = $(this).val();
            if (temp == 2 || temp == 5) {
                var item = $($("select.consentList")[$("select.restrictionList").index(this)]);
                if (item.val() == 0) {
                    var newDialog = $('<div id="MenuDialog">\             <p>' + messages.consentPeriod + '</p>\         </div>');
                    //Show Dialog
                    newDialog.dialog({
                        modal: true,
                        title: messageCommon.warningTitle,
                        show: 'clip',
                        hide: 'clip',
                        width: 300,
                        buttons: { 'Ok': function () { $(this).dialog('close'); item.focus(); } },
                        close: function () { item.focus(); }
                    });
                    result = false;
                    return false;
                }
            }
            return false;
        });

        //
        if (result == true) {
           $.post('/GCS/Contract/SaveContractTemplate', $("#SecExpForm").serialize(), function(data) {
                $('#divSecTab').html(data);
            })
                .error(function() {
                    var newDialog = $('<div id="MenuDialog">\             <p> ' + e + ' </p>\         </div>');
                    //Show Dialog
                    newDialog.dialog({
                        modal: true,
                        title: messageCommon.warningTitle,
                        show: 'clip',
                        hide: 'clip',
                        width: 300
                    });
                });

        }
        //
    });

});




$(function () {
    $('#applyRestriction').click(function (e) {
        e.preventDefault();
        $("select.restrictionList").each(function () {
            var temp = $($("select.restrictedList")[$("select.restrictionList").index(this) + 1]).val();
            if (temp == 1)
                $($("select.restrictionList")[$("select.restrictionList").index(this) + 1]).val($($("select.restrictionList")[$("select.restrictionList").index(0)]).val());
        });
        $('select.restrictionList').each(function () {
            var temp = $(this).val();

            if (temp == 1 || temp == 3 || temp == 4) {
                $($("select.consentList")[$("select.restrictionList").index(this)]).attr("disabled", true);
            }
            else {
                $($("select.consentList")[$("select.restrictionList").index(this)]).attr("disabled", false);
            }
        }); 
    });
});


$(function () {

    $('#applyRestricted').click(function (e) {
        e.preventDefault();
        $("select.restrictedList").each(function () {
            $($("select.restrictedList")[$("select.restrictedList").index(this) + 1]).val($(this).val());
            var temp = $($("select.restrictedList")[$("select.restrictedList").index(this)]).val();

            if (temp == 2) {
                $($("select.restrictionList")[$("select.restrictedList").index(this)]).val(4);
                $($("select.restrictionList")[$("select.restrictedList").index(this)]).attr("disabled", true);
                $($("select.consentList")[$("select.restrictedList").index(this)]).val(0);
                $($("select.consentList")[$("select.restrictedList").index(this)]).attr("disabled", true);
                $($("input.HoldBack")[$("select.restrictedList").index(this)]).val("");
                $($("input.HoldBack")[$("select.restrictedList").index(this)]).attr("disabled", true);
            }
            else {
                $($("select.restrictionList")[$("select.restrictedList").index(this)]).removeAttr("disabled");
                $($("select.consentList")[$("select.restrictedList").index(this)]).removeAttr("disabled");
                $($("input.HoldBack")[$("select.restrictedList").index(this)]).removeAttr("disabled");     

            }
        });
    });
});


$(function () {
    $('#applyConsent').click(function (e) {
        e.preventDefault();


        $("select.consentList").each(function () {

            var temp = $($("select.restrictedList")[$("select.consentList").index(this) + 1]).val();
            if (temp == 1)
                $($("select.consentList")[$("select.consentList").index(this) + 1]).val($($("select.consentList")[$("select.consentList").index(0)]).val());
           
        });

    });
});


$(function () {
    $('#applyHoldBack').click(function (e) {
        e.preventDefault();
        $("input.HoldBack").each(function () {
            var temp = $($("select.restrictedList")[$("input.HoldBack").index(this) + 1]).val();
            if (temp == 1)
                $($("input.HoldBack")[$("input.HoldBack").index(this) + 1]).val($($("input.HoldBack")[$("input.HoldBack").index(0)]).val());
        });
    });
});


$(function () {
    $('#applyNotes').click(function (e) {
        e.preventDefault();
        $("input.Notes").each(function () {
            $($("input.Notes")[$("input.Notes").index(this) + 1]).val($(this).val());
        });
    });
});




$(function () {
    $('select.restrictedList').change(function () {
        var temp = $(this).val();

        if (temp == 2) {
            $($("select.restrictionList")[$("select.restrictedList").index(this)]).val(4);
            $($("select.restrictionList")[$("select.restrictedList").index(this)]).attr("disabled", true);
            $($("select.consentList")[$("select.restrictedList").index(this)]).val(0);
            $($("select.consentList")[$("select.restrictedList").index(this)]).attr("disabled", true);
            $($("input.HoldBack")[$("select.restrictedList").index(this)]).val("");
            $($("input.HoldBack")[$("select.restrictedList").index(this)]).attr("disabled", true);
        }
        else {
            $($("select.restrictionList")[$("select.restrictedList").index(this)]).removeAttr("disabled");
            $($("select.consentList")[$("select.restrictedList").index(this)]).removeAttr("disabled");
            $($("input.HoldBack")[$("select.restrictedList").index(this)]).removeAttr("disabled");            
        }
    });
});

$(document).ready(function () {

    Restrictionbasedvalidation();
    var user;
    if (document.URL.indexOf('ViewContract') >= 0) {
        user = $("#UserRoleName").val();
        if (user == "ReadOnlyUser") {
            ReadOnlyUser();
        }
        else if (user == "ReadOnlyBasicUser") {
            ReadOnlyBasicUser();
        }
        else if (user == "PowerUser") {
            PowerUser();
        }
        else {
            EditorReviewerUser();
            Restrictionbasedvalidation();
        }
    }

    if (document.URL.indexOf('EditContract') >= 0) {
        user = $("#UserRoleName").val();
        if (user == "PowerUser") {
            PowerUser();
        }
        else {
            EditorReviewerUser();
            Restrictionbasedvalidation();
        }
    }

    $('select.restrictionList').each(function () {
        var temp = $(this).val();
       
        if (temp == 1 || temp == 3 || temp == 4) {
            $($("select.consentList")[$("select.restrictionList").index(this)]).attr("disabled", true);
        }
        else if (user == "ReadOnlyUser" || user == "ReadOnlyBasicUser") {
            $($("select.consentList")[$("select.restrictionList").index(this)]).attr("disabled", true);
        }
        else {
            $($("select.consentList")[$("select.restrictionList").index(this)]).attr("disabled", true);
        }
    });
});

function Restrictionbasedvalidation() {
    $('select.restrictedList').each(function () {
        var temp = $(this).val();

        if (temp == 2) {
            $($("select.restrictionList")[$("select.restrictedList").index(this)]).val(4);
            $($("select.restrictionList")[$("select.restrictedList").index(this)]).attr("disabled", true);
            $($("select.consentList")[$("select.restrictedList").index(this)]).val(0);
            $($("select.consentList")[$("select.restrictedList").index(this)]).attr("disabled", true);
            $($("input.HoldBack")[$("select.restrictedList").index(this)]).val("");
            $($("input.HoldBack")[$("select.restrictedList").index(this)]).attr("disabled", true);
        }
        else {
            $($("select.restrictionList")[$("select.restrictedList").index(this)]).removeAttr("disabled");
            $($("select.consentList")[$("select.restrictedList").index(this)]).removeAttr("disabled");
            $($("input.HoldBack")[$("select.restrictedList").index(this)]).removeAttr("disabled");
        }
    });

}